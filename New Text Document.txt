Some bugs were fixed
 by me